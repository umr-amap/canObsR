<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create-compatible-crown-delineation-file • canObsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create-compatible-crown-delineation-file">
</head>
<body>
<p>








  pkgdown/custom.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    pkgdown/home.html

    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">canObsR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/umr-amap/canObsR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create-compatible-crown-delineation-file</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/umr-amap/canObsR/blob/master/vignettes/Create-compatible-crown-delineation-file.Rmd" class="external-link"><code>vignettes/Create-compatible-crown-delineation-file.Rmd</code></a></small>
      <div class="d-none name"><code>Create-compatible-crown-delineation-file.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<p>The extraction of crown images and crown indices requires a
compatible crown delineation file. The function <a href="https://umr-amap.github.io/canObsR/reference/check_crownFile.html"><code>check_crownFile()</code></a>
tests each requirement of the file and return the necessary
modifications to do to make the file compatible.</p>
<p>To be compatible with the package functions the crown delineation
file must have :<br>
- at least the variables ‘id’, ‘species’, ‘genus’ and ‘family’<br>
- ‘species’, ‘genus’ and ‘family’ should not have NA. Replace them by
‘indet’<br>
- ‘id’ should not have duplicated values.</p>
</div>
<div class="section level2">
<h2 id="check-the-compatibility-and-adapt-the-file">Check the compatibility and adapt the file<a class="anchor" aria-label="anchor" href="#check-the-compatibility-and-adapt-the-file"></a>
</h2>
<p>The following example shows how to adjust the crown delineation file
to make it compatible. It uses data from the</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://umr-amap.github.io/canObsR/">canObsR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">crownFile</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">crownFile</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 189</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ id        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>9<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>12<span style="color: #949494;">, </span>13<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>16<span style="color: #949494;">, </span>17<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ tx_sp_lvl <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Piptadeniastrum africanum"<span style="color: #949494;">, </span>"Musanga cecropioides"<span style="color: #949494;">, </span>"Distem…</span></span>
<span><span class="co">#&gt; $ tax_gen   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Piptadeniastrum"<span style="color: #949494;">, </span>"Musanga"<span style="color: #949494;">, </span>"Distemonanthus"<span style="color: #949494;">, </span>"Celtis"<span style="color: #949494;">, </span>"D…</span></span>
<span><span class="co">#&gt; $ tax_fam   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Fabaceae"<span style="color: #949494;">, </span>"Urticaceae"<span style="color: #949494;">, </span>"Fabaceae"<span style="color: #949494;">, </span>"Cannabaceae"<span style="color: #949494;">, </span>"Fabace…</span></span>
<span><span class="co">#&gt; $ geom      <span style="color: #949494; font-style: italic;">&lt;POLYGON [m]&gt;</span> POLYGON ((257776.3 352837.7...<span style="color: #949494;">, </span>POLYGON ((257817.3 3…</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">crownFile</span><span class="op">$</span><span class="va">geom</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Create-compatible-crown-delineation-file_files/figure-html/unnamed-chunk-2-1.png" alt="Crown delineation file" width="700"><p class="caption">
Crown delineation file
</p>
</div>
</div>
<div class="section level2">
<h2 id="adjust-the-variable-names">Adjust the variable names<a class="anchor" aria-label="anchor" href="#adjust-the-variable-names"></a>
</h2>
<p>Check if the variables ‘id’, ‘species’, ‘genus’ and ‘family’ are in
the file. Change the variable names or create empty variables if you do
not have the information. id must be <int> or <num> and ‘species’,
‘genus’ and ‘family’ must be <chr>.</chr></num></int></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_crownFile.html">check_crownFile</a></span><span class="op">(</span><span class="va">crownFile</span><span class="op">)</span></span>
<span><span class="co">#&gt; ##########     VARIABLES CHECK     ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅    id</span></span>
<span><span class="co">#&gt; ❌    family variable missing or not well named</span></span>
<span><span class="co">#&gt; ❌    genus variable missing or not well named</span></span>
<span><span class="co">#&gt; ❌    species variable missing or not well named</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########    NA VARIABLES CHECK   ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅    No NA for the variable  id</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########           CRS           ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; CRS : WGS 84 / UTM zone 33N</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########   DUPLICATED ID CHECK   ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅  There is no duplicated id</span></span>
<span></span>
<span><span class="va">crownFile</span> <span class="op">=</span> <span class="va">crownFile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>      family <span class="op">=</span> <span class="va">tax_fam</span>,         <span class="co"># Rename the corresponding variable as 'family'</span></span>
<span>      genus <span class="op">=</span> <span class="va">tax_gen</span>,          <span class="co"># Rename the corresponding variable as 'genus'</span></span>
<span>      species <span class="op">=</span> <span class="va">tx_sp_lvl</span>       <span class="co"># Rename the corresponding variable as 'species'</span></span>
<span>   <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="replace-na-by-indet">Replace NA by ‘indet’<a class="anchor" aria-label="anchor" href="#replace-na-by-indet"></a>
</h2>
<p>Check if you have NA in ‘id’, ‘species’, ‘genus’ and ‘family’
variables. NA from ‘species’, ‘genus’ and ‘family’ must be replace by
‘indet’ and just NA from ‘id’.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_crownFile.html">check_crownFile</a></span><span class="op">(</span><span class="va">crownFile</span><span class="op">)</span></span>
<span><span class="co">#&gt; ##########     VARIABLES CHECK     ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅    id</span></span>
<span><span class="co">#&gt; ✅    family</span></span>
<span><span class="co">#&gt; ✅    genus</span></span>
<span><span class="co">#&gt; ✅    species</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########    NA VARIABLES CHECK   ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅    No NA for the variable  id</span></span>
<span><span class="co">#&gt; ❌    Transform NA to 'indet' for the variable -&gt; family</span></span>
<span><span class="co">#&gt; ❌    Transform NA to 'indet' for the variable -&gt; genus</span></span>
<span><span class="co">#&gt; ❌    Transform NA to 'indet' for the variable -&gt; species</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########           CRS           ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; CRS : WGS 84 / UTM zone 33N</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########   DUPLICATED ID CHECK   ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅  There is no duplicated id</span></span>
<span></span>
<span></span>
<span><span class="va">crownFile</span> <span class="op">=</span> <span class="va">crownFile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      <span class="co"># Rename NA to 'indet' in the family variable</span></span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">~</span> <span class="st">'indet'</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">family</span><span class="op">)</span>,</span>
<span>      <span class="co"># Same for genus</span></span>
<span>      genus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">~</span> <span class="st">'indet'</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">genus</span><span class="op">)</span>,</span>
<span>      <span class="co"># Same for species</span></span>
<span>      species <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">genus</span>, <span class="st">'indet'</span><span class="op">)</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="last-check">Last check<a class="anchor" aria-label="anchor" href="#last-check"></a>
</h2>
<p>When the function does not indicate error, the file is compatible
!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_crownFile.html">check_crownFile</a></span><span class="op">(</span><span class="va">crownFile</span><span class="op">)</span></span>
<span><span class="co">#&gt; ##########     VARIABLES CHECK     ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅    id</span></span>
<span><span class="co">#&gt; ✅    family</span></span>
<span><span class="co">#&gt; ✅    genus</span></span>
<span><span class="co">#&gt; ✅    species</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########    NA VARIABLES CHECK   ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅    No NA for the variable  id</span></span>
<span><span class="co">#&gt; ✅    No NA for the variable  family</span></span>
<span><span class="co">#&gt; ✅    No NA for the variable  genus</span></span>
<span><span class="co">#&gt; ✅    No NA for the variable  species</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########           CRS           ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; CRS : WGS 84 / UTM zone 33N</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ##########   DUPLICATED ID CHECK   ##########</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt; ✅  There is no duplicated id</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hugo Leblanc.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>



  pkgdown/footer.html

  
</body>
</html>
